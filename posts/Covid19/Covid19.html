<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Regressions on Early COVID-19 Data</title>

   <!-- Bootstrap Core CSS -->
   <link href="/css/bootstrap.min.css" rel="stylesheet">

   <!-- Theme CSS -->
   <link href="/css/clean-blog.min.css" rel="stylesheet">

   <!-- LaTex Rendering with MathJax-->
   <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
   <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>

<body>

    <!-- Navigation -->
    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    <li> <a href="/index.html">math and philosophy blog</a> </li>
                    <li> <a href="/e&p.html">Programming and Engineering Projects</a> </li>
                    <li> <a href="/about.html">About </a> </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <!-- Page Header -->
    <!-- Set your background image for this header on the line below. -->
    <header class="intro-header" style="background-image: url('/img/bw.jpg')">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <div class="post-heading">
                        <h1>Polynomial Regression on Early COVID-19 Data </h1>
                        <h2 class="subheading">Python, SQLite</h2>
                        <span class="meta">Posted on July 14, 2020</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Post Content -->
    <article>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <p>Early in the pandemic, I wanted to perform a regression on the number of cases in the U.S. to see what function would best fit the data. I am aware that the growth of infection cases is usually exponential, but due to the lack of testing and reporting, the number of cases seemed to have a polynomial growth&mdash;something like a 5th degree polynomial. </p>

                    <p>
                        This is not supposed to be serious model for modeling the growth of case numbers. The standard model for that is the SIR model, but is more complicated. This is just a small project for me to learn how to perform regressions in Python and work with SQL databases. I might do a Python implementation of the SIR model at some other point.
                    </p>

                    <h2 class="section-heading">Webscraping the Covid-19 Data</h2>

                    <p>
                        I wrote a short python script that creates a database with SQLite, downloads the data on infection cases in the U.S. from the CDC's website, and then  
                    </p>

                    <figure>
                        <figcaption></figcaption>
                        <pre>
                          <code>
# ///////////////////////// Webscraping the Covid-19 Data /////////////////////////////////
import requests
import urllib.request
import time
from bs4 import BeautifulSoup
import json

# Set the URL you want to webscrape from
url = 'https://www.cdc.gov/coronavirus/2019-ncov/json/new-cases-chart-data.json'
print("url =", url,'\n')

# Connect to the URL
response = requests.get(url)

# Parse HTML and save to BeautifulSoup object
soup = BeautifulSoup(response.text, "html.parser")

# Decode the JSON file into a list of lists
data=json.loads(str(soup))
                          </code>
                        </pre>
                      </figure>

                    <p>
                        I originally tried to download the data by searching the Beautiful Soup object, but then realized that the data is being loaded in an iframe so there were no HTML table tags in the Beautiful Soup object. The fast solution I saw was just to take it straight from the JSON file.
                    </p>

                    <h2 class="section-heading">Creating the Database</h2>

                    <p> 
                        For performing the regression, creating the database with SQLite is more work than required. I could have skipped this entire step as the infection cases are already in <b>data</b>, but I wanted to learn a bit of SQL so I took the extra unnecessary step. 
                    </p>

                    <p> 
                        I choose March 16 as the starting date because that was the first date that started a 3-day growth. Before that cases where very small and were fluctuating a lot. This seems to be where things really took off. I chose 10 days of data because I like the number 10. 
                    </p>

                    <figure>
                        <figcaption></figcaption>
                        <pre>
                          <code>
# /////////////////////// Creating the Covid-19 database with SQLite ///////////////////////
import sqlite3 as sql

# Create a database and open a connection to it
connection = sql.connect('CovidCaseData.db')
terminal = connection.cursor()

# Create a table within database for infection cases
terminal.execute("""CREATE TABLE infectionCases (
        
    date text,
    cases integer
    
    )""")

# Insert all of the cases into the table from March 16, 2020 to March 25, 2020
for i in range(54,65):
    terminal.execute("INSERT INTO infectionCases VALUES (:date,:cases)", {'date':data[0][i], 'cases':data[1][i]} )
                          </code>
                        </pre>
                      </figure>

                    <h2 class="section-heading">Performing the Polynomial Regression in Python</h2>

                    <p>
                        I performed the regression on the first 60 days of infection case data in the U.S. to find the 5th degree polynomial that minimzes the squared error. 
                    </p>
                      
                    <p>
                        This is the polynomial plotted alongside the first 100 days of infection case data in the U.S. 
                    </p>

                    <a href="">
                        <img class="img-responsive" src="Figure_1.png" style="width:1000px;height:250px;">
                    </a>

                </br> </br>

                    <figure>
                        <figcaption></figcaption>
                        <pre>
                          <code>
# ////////////////// Performing the regression ////////////////////////////////////////////
import numpy as np
import scipy as sp
import matplotlib.pyplot as plt

# Create numpy arrays 
x = np.array( list( range(60) ) )
y = np.array( list( range(60) ) )

# Fill in the range array with infection case numbers for the first 60 days from database
terminal.execute("SELECT cases FROM infectionCases")
casesCol = terminal.fetchall()

for i in range(60):
    y[i]=casesCol[i][0]

# Create an array with the case numbers for the first 100 days
X = np.array( list( range(100) ) )
Y = np.array( list( range(100) ) )
for i in range(99):
    Y[i]=casesCol[i][0]

# Perform a least-squares 5th degree polynomial fit on the case numbers for the first 60 days
poly = np.polyfit(x,y,5)

# Plot the first 100 days of the pandemic and the polynomial regression line
xp = np.linspace(0,100,100)
plt.plot(X,Y,'.')
plt.axvline(x=60,linewidth=1, color='k')
plt.plot(xp,np.polyval(poly,xp),'k-')
plt.ylim(0,35000)
plt.show()
                          </code>
                        </pre>
                      </figure>


                    <h2 class="section-heading">Conclusion</h2>

                    <p>
                        The number of reported cases in the U.S. seemed to have a polynomial growth. 
                    </p>

                </div>
            </div>
        </div>
    </article>

    <hr>



    <!-- Bootstrap Core JavaScript -->
    <script src="/js/bootstrap.min.js"></script>


    <!-- Theme JavaScript -->
    <script src="/js/clean-blog.min.js"></script>

</body>

</html>
